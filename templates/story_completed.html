{% extends "base.html" %}

{% block content %}
<div style="text-align: center; margin-bottom: 30px;">
    <h2 style="color: #28a745;">âœ“ Story Completed!</h2>
    <h3 style="color: #667eea; margin-top: 10px;">{{ story.title }}</h3>
</div>

<div class="card" style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border: none;">
    <h3 style="margin-top: 0;">How was your experience?</h3>
    <p style="color: #666;">Help us recommend better stories by sharing your feedback (optional).</p>
</div>

<!-- Mood Section -->
<div class="card">
    <h3 style="margin-top: 0;">ğŸ˜Š How do you feel now?</h3>
    
    {% if mood_before %}
    <p style="color: #666; margin-bottom: 15px;">
        Your mood before reading: <strong>{{ mood_before }}/10</strong>
    </p>
    {% endif %}
    
    <form method="POST" action="{{ url_for('submit_mood_after', story_id=story.id) }}">
        <input type="hidden" name="next" value="story_completed">
        <div class="mood-selector">
            <button type="submit" name="mood" value="1" class="mood-btn" title="Very Low (1)">ğŸ˜¢</button>
            <button type="submit" name="mood" value="2" class="mood-btn" title="Low (2)">ğŸ˜•</button>
            <button type="submit" name="mood" value="3" class="mood-btn" title="Low-Medium (3)">ğŸ˜</button>
            <button type="submit" name="mood" value="4" class="mood-btn" title="Below Average (4)">ğŸ™‚</button>
            <button type="submit" name="mood" value="5" class="mood-btn" title="Average (5)">ğŸ˜Š</button>
            <button type="submit" name="mood" value="6" class="mood-btn" title="Above Average (6)">ğŸ˜„</button>
            <button type="submit" name="mood" value="7" class="mood-btn" title="Good (7)">ğŸ˜ƒ</button>
            <button type="submit" name="mood" value="8" class="mood-btn" title="Very Good (8)">ğŸ˜</button>
            <button type="submit" name="mood" value="9" class="mood-btn" title="Great (9)">ğŸ¤©</button>
            <button type="submit" name="mood" value="10" class="mood-btn" title="Excellent (10)">ğŸ¥³</button>
        </div>
    </form>
    
    <p style="text-align: center; color: #999; font-size: 0.9em; margin-top: 10px;">
        Select your current mood (optional)
    </p>
</div>

<!-- Like Section -->
<div class="card">
    <h3 style="margin-top: 0;">â¤ï¸ Did you enjoy this story?</h3>
    
    {% if already_liked %}
        <div class="alert alert-success">
            <strong>âœ“ You've already liked this story!</strong>
        </div>
    {% else %}
        <form method="POST" action="{{ url_for('like_story', story_id=story.id) }}" style="margin-top: 15px;">
            <button type="submit" class="btn" style="background: #e91e63; font-size: 1.1em;">
                â¤ï¸ Like This Story
            </button>
        </form>
        <p style="color: #666; margin-top: 10px; font-size: 0.9em;">
            Liking stories helps us understand your preferences and recommend similar ones.
        </p>
    {% endif %}
</div>

<!-- Navigation -->
<div style="margin-top: 30px; text-align: center; padding-top: 20px; border-top: 2px solid #eee;">
    <h3>What would you like to do next?</h3>
    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px;">
        <a href="{{ url_for('recommendations') }}" class="btn" style="font-size: 1.1em;">
            ğŸ“– Get More Recommendations
        </a>
        <a href="{{ url_for('index') }}" class="btn btn-secondary">
            ğŸ  Back to Home
        </a>
        <a href="{{ url_for('insights') }}" class="btn btn-secondary">
            ğŸ“Š View Insights
        </a>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Show confirmation when mood or like is submitted
    document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', function(e) {
            // Visual feedback
            const button = this.querySelector('button[type="submit"]');
            if (button) {
                button.style.opacity = '0.6';
                const originalText = button.innerHTML;
                button.innerHTML = originalText + ' âœ“';
            }
        });
    });
</script>
{% endblock %}
